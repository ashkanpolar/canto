<!-- /snippets/site-nav.liquid -->

<ul class="site-nav" id="AccessibleNav">

  {% for link in navigation.main-menu.links %}

        {% assign child_list_handle = link.url | handleize | default: '__default__' %}
        {% if navigation[child_list_handle].links != blank %}
          <li class="site-nav--has-dropdown{% if link.active %} site-nav--active{% endif %}" aria-haspopup="true">
            <a  class="site-nav__link">{{ link.name }}</a>
            <ul class="site-nav__dropdown">
              {% for childlink in navigation[child_list_handle].links %}

                {% assign sub_child_list_handle = childlink.url | handleize | default: '__default__' %}
                {% if navigation[sub_child_list_handle].links != blank %}
                    <li class="site-nav--has-dropdown{% if childlink.active %} site-nav--active{% endif %}" aria-haspopup="true">

                        <a  class="site-nav__link">{{ childlink.name }}</a>
                        <ul class="site-nav__dropdown">
                        {% for subchildlink in navigation[sub_child_list_handle].links %}
                            <li{% if subchildlink.active %} class="site-nav--active"{% endif %}>
                              <a href="{{ subchildlink.url }}" class="site-nav__link">{{ subchildlink.name | escape }}</a>
                            </li>
                        {% endfor %}
                        </ul>
                    </li>
                {% else %}

                    <li{% if childlink.active %} class="site-nav--active"{% endif %}>
                      <a href="{{ childlink.url }}" class="site-nav__link">{{ childlink.name | escape }}</a>
                    </li>

                {% endif %}

              {% endfor %}
            </ul>
          </li>
        {% else %}
          <li {% if link.active %}class="site-nav--active"{% endif %}>
            <a href="{{ link.url }}" class="site-nav__link">{{ link.name }}</a>
          </li>
        {% endif %}

  {% endfor %}
</ul>
